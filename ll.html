<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crazy Ping Pong Mayhem</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            background: #000;
            color: #fff;
        }
        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
        #ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        #score {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: #fff;
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #00ffff;
        }
        #power-meter {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid #fff;
        }
        #power-fill {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff00ff, #00ffff);
            transition: width 0.3s;
        }
        .effect {
            position: absolute;
            pointer-events: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        .powerup {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: radial-gradient(circle, #ff00ff, #00ffff);
            animation: float 2s infinite, spin 3s linear infinite;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div id="ui-overlay">
            <div id="score">Score: 0</div>
            <div id="power-meter"><div id="power-fill"></div></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const powerFill = document.getElementById('power-fill');

        let width, height, paddleHeight, paddleWidth, ballSize;
        let leftPaddle, rightPaddle, ball, score, powerLevel;
        let powerups = [];
        let effects = [];
        let gameLoop;

        function resizeCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            paddleHeight = height / 6;
            paddleWidth = width / 60;
            ballSize = width / 60;
            initGame();
        }

        function initGame() {
            leftPaddle = { x: width / 30, y: height / 2 - paddleHeight / 2, dy: 0 };
            rightPaddle = { x: width - width / 30 - paddleWidth, y: height / 2 - paddleHeight / 2, dy: 0 };
            ball = { x: width / 2, y: height / 2, dx: 5, dy: 5 };
            score = 0;
            powerLevel = 0;
        }

        function drawPaddle(x, y) {
            ctx.fillStyle = '#fff';
            ctx.fillRect(x, y, paddleWidth, paddleHeight);
        }

        function drawBall(x, y) {
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(x, y, ballSize / 2, 0, Math.PI * 2);
            ctx.fill();
        }

        function movePaddles() {
            if (keys.ArrowUp && rightPaddle.y > 0) rightPaddle.y -= 5;
            if (keys.ArrowDown && rightPaddle.y < height - paddleHeight) rightPaddle.y += 5;
            
            // AI for left paddle
            if (ball.y < leftPaddle.y + paddleHeight / 2) {
                leftPaddle.dy = -4;
            } else if (ball.y > leftPaddle.y + paddleHeight / 2) {
                leftPaddle.dy = 4;
            }
            leftPaddle.y += leftPaddle.dy;
            leftPaddle.y = Math.max(0, Math.min(height - paddleHeight, leftPaddle.y));
        }

        function moveBall() {
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Collision with top and bottom
            if (ball.y - ballSize / 2 < 0 || ball.y + ballSize / 2 > height) {
                ball.dy = -ball.dy;
                createEffect(ball.x, ball.y, 'bounce');
            }

            // Collision with paddles
            if (
                (ball.x - ballSize / 2 < leftPaddle.x + paddleWidth && ball.y > leftPaddle.y && ball.y < leftPaddle.y + paddleHeight) ||
                (ball.x + ballSize / 2 > rightPaddle.x && ball.y > rightPaddle.y && ball.y < rightPaddle.y + paddleHeight)
            ) {
                ball.dx = -ball.dx * 1.1;  // Increase speed slightly
                createEffect(ball.x, ball.y, 'hit');
                increasePower();
            }

            // Scoring
            if (ball.x < 0 || ball.x > width) {
                score++;
                scoreElement.textContent = `Score: ${score}`;
                ball.x = width / 2;
                ball.y = height / 2;
                ball.dx = (Math.random() > 0.5 ? 5 : -5);
                ball.dy = (Math.random() > 0.5 ? 5 : -5);
            }
        }

        function createEffect(x, y, type) {
            const effect = document.createElement('div');
            effect.className = 'effect';
            effect.style.left = `${x}px`;
            effect.style.top = `${y}px`;
            
            if (type === 'bounce') {
                effect.style.width = '50px';
                effect.style.height = '50px';
                effect.style.background = 'radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%)';
            } else if (type === 'hit') {
                effect.style.width = '100px';
                effect.style.height = '100px';
                effect.style.background = 'radial-gradient(circle, rgba(255,0,255,0.8) 0%, rgba(0,255,255,0.8) 50%, rgba(255,255,255,0) 70%)';
            }

            document.getElementById('game-container').appendChild(effect);
            effects.push({ element: effect, createdAt: Date.now() });
        }

        function manageEffects() {
            const now = Date.now();
            effects = effects.filter(effect => {
                if (now - effect.createdAt > 500) {
                    effect.element.remove();
                    return false;
                }
                return true;
            });
        }

        function createPowerup() {
            if (Math.random() < 0.005 && powerups.length < 3) {
                const powerup = document.createElement('div');
                powerup.className = 'powerup';
                powerup.style.left = `${Math.random() * (width - 30)}px`;
                powerup.style.top = `${Math.random() * (height - 30)}px`;
                document.getElementById('game-container').appendChild(powerup);
                powerups.push({ element: powerup, x: parseFloat(powerup.style.left), y: parseFloat(powerup.style.top) });
            }
        }

        function checkPowerupCollision() {
            powerups = powerups.filter(powerup => {
                if (
                    ball.x > powerup.x &&
                    ball.x < powerup.x + 30 &&
                    ball.y > powerup.y &&
                    ball.y < powerup.y + 30
                ) {
                    activatePowerup();
                    powerup.element.remove();
                    return false;
                }
                return true;
            });
        }

        function activatePowerup() {
            const effects = ['giant-ball', 'multi-ball', 'reverse-controls'];
            const effect = effects[Math.floor(Math.random() * effects.length)];
            
            switch (effect) {
                case 'giant-ball':
                    ballSize *= 3;
                    setTimeout(() => ballSize /= 3, 5000);
                    break;
                case 'multi-ball':
                    for (let i = 0; i < 3; i++) {
                        const newBall = { ...ball, dx: (Math.random() - 0.5) * 10, dy: (Math.random() - 0.5) * 10 };
                        setTimeout(() => ball = newBall, i * 1000);
                    }
                    break;
                case 'reverse-controls':
                    const originalControls = { ...keys };
                    keys.ArrowUp = originalControls.ArrowDown;
                    keys.ArrowDown = originalControls.ArrowUp;
                    setTimeout(() => {
                        keys.ArrowUp = originalControls.ArrowUp;
                        keys.ArrowDown = originalControls.ArrowDown;
                    }, 5000);
                    break;
            }
        }

        function increasePower() {
            powerLevel = Math.min(100, powerLevel + 10);
            powerFill.style.width = `${powerLevel}%`;
            if (powerLevel === 100) {
                activateSuperPower();
            }
        }

        function activateSuperPower() {
            ball.dx *= 2;
            ball.dy *= 2;
            setTimeout(() => {
                ball.dx /= 2;
                ball.dy /= 2;
            }, 5000);
            powerLevel = 0;
            powerFill.style.width = '0%';
        }

        function gameLoop() {
            ctx.clearRect(0, 0, width, height);
            movePaddles();
            moveBall();
            drawPaddle(leftPaddle.x, leftPaddle.y);
            drawPaddle(rightPaddle.x, rightPaddle.y);
            drawBall(ball.x, ball.y);
            createPowerup();
            checkPowerupCollision();
            manageEffects();
            requestAnimationFrame(gameLoop);
        }

        const keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);
        window.addEventListener('resize', resizeCanvas);

        resizeCanvas();
        gameLoop();
    </script>
</body>
</html>